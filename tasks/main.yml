---
# tasks file for elasticsearch/

- include: main-apt.yml
  when: ansible_os_family == "Debian"

- include: main-plugins.yml

# https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-synonym-tokenfilter.html
# http://wordnetcode.princeton.edu/3.0/WNprolog-3.0.tar.gz
#{
#    "index" : {
#        "analysis" : {
#            "analyzer" : {
#                "synonym" : {
#                    "tokenizer" : "whitespace",
#                    "filter" : ["synonym"]
#                }
#            },
#            "filter" : {
#                "synonym" : {
#                    "type" : "synonym",
#                    "format" : "wordnet",
#                    "synonyms_path" : "analysis/synonym.txt"
#                }
#            }
#        }
#    }
#}
#
# The above configures a synonym filter, with a path of analysis/synonym.txt (relative to the config location).

- file: path=/etc/elasticsearch/analysis state=directory
- copy: src=synonyms.pl dest=/etc/elasticsearch/analysis/synonyms.txt owner=root group=root mode=0644

# https://www.elastic.co/guide/en/elasticsearch/reference/5.x/settings.html

# Environment variables
- template: src=jvm.options.j2 dest=/etc/elasticsearch/jvm.options owner=root group=root mode=0755

# Configuration
- template: src=elasticsearch.yml.j2 dest=/etc/elasticsearch/elasticsearch.yml owner=root group=root mode=0644
  notify: restart-elasticsearch

- template: src=log4j2.properties.j2 dest=/etc/elasticsearch/log4j2.properties owner=root group=root mode=0644
  notify: restart-elasticsearch
